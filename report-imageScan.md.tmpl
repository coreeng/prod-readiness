# Image Scanning

{{- range $keyArea, $area := .ImageScan.ImageByArea }}

## Vulnerabilities for {{ $area.AreaName }}

| Total Image Count | Total Replica Count | Total Critical| Total High | Total Medium | Total Low | Total Unknown |
|--------|----------|---------|------|--------|-----|-----|
| {{ $area.Summary.ImageCount }} | {{ $area.Summary.PodCount }} | {{ index $area.Summary.TotalVulnerabilityPerCriticality "CRITICAL" }} | {{ index $area.Summary.TotalVulnerabilityPerCriticality "HIGH" }} | {{ index $area.Summary.TotalVulnerabilityPerCriticality "MEDIUM" }} | {{ index $area.Summary.TotalVulnerabilityPerCriticality "LOW" }} | {{ index $area.Summary.TotalVulnerabilityPerCriticality "UNKNOWN" }}|

{{- range $keyTeam, $team := $area.Teams }}

### Vulnerabilities for {{ $area.AreaName }} - {{ $team.TeamName }}

#### Summary

| Images | Replicas | Critical| High | Medium | Low | Unknown |
|--------|----------|---------|------|--------|-----|-----|
{{- range $key, $specs := $team.Summary.ImageVulnerabilitySummary }}
| {{ $key }} | {{ $specs.PodCount }} | {{ index $specs.TotalVulnerabilityPerCriticality "CRITICAL" }} | {{ index $specs.TotalVulnerabilityPerCriticality "HIGH" }} | {{ index $specs.TotalVulnerabilityPerCriticality "MEDIUM" }} | {{ index $specs.TotalVulnerabilityPerCriticality "LOW" }} | {{ index $specs.TotalVulnerabilityPerCriticality "UNKNOWN" }}|
{{- end }}

#### Vulnerabilities details

| Image | CVE | Severity | PkgName | Description |
|-------|-----|----------|---------|-------------|
{{ range $key, $specs := $team.Images }}
{{- range $trivyKeyOutput, $trivyOutput := $specs.TrivyOutput }}
{{- if $trivyOutput.Vulnerabilities }}
{{- range $trivyKey, $trivySpecs := $trivyOutput.Vulnerabilities }}
{{- $description := $trivySpecs.Title -}}
{{- if not $trivySpecs.Title -}}
{{- $description = $trivySpecs.Description -}}
{{- end -}}
| {{ $specs.ImageName }} | [{{ $trivySpecs.VulnerabilityID }}](https://nvd.nist.gov/vuln/detail/{{ $trivySpecs.VulnerabilityID }}) | {{ $trivySpecs.Severity }} | {{ $trivySpecs.PkgName }} | {{ truncate $description 105 }} |
{{ end}} {{/* end of team if vulnerabilities */}}
{{- end}} {{/* end of team vulnerabilities */}}
{{- end}} {{/* end of team trivy output */}}
{{- end}} {{/* end of team images */}}
{{- end}} {{/* end of team */}}
{{- end}} {{/* end of area */}}
