# CIS Benchmark - Kubernetes
{{ safe "<!-- .element: class=\"title-first-page\" -->" }}
{{ safe "<!-- .slide: data-background-image=\"../../assets/images/deck-title-page-big.jpg\" -->" }}


### Number of Masters scanned: {{ .KubeCIS.MasterCount }}
{{ safe "<!-- .element: class=\"title-detailed-page\" -->" }}
{{ safe "<div style=\"display: block; text-align: left;\">" }}

{{- range $reportKey, $reportSpecs := .KubeCIS.MasterReport }}
{{ $node := index $reportSpecs.Node 0 }} 

**Os**: {{ $node.Status.NodeInfo.OSImage }} - **KernelVersion**: {{ $node.Status.NodeInfo.KernelVersion }} - **Kubelet version**: {{ $node.Status.NodeInfo.KubeletVersion }}  
{{ safe "<!-- .element: class=\"title-report\" -->" }}

**Masters**: {{ range $nodeKey, $nodeSpecs := $reportSpecs.Node -}} {{ $nodeSpecs.Name }} {{ end }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}

{{- end }} 
{{ safe "</div>" }}

### Number of Nodes scanned: {{ .KubeCIS.NodeCount }}
{{ safe "<!-- .element: class=\"title-detailed-page\" -->" }}
{{ safe "<div style=\"display: block; text-align: left;\">" }}

{{- range $reportKey, $reportSpecs := .KubeCIS.NodeReport }}
{{ $node := index $reportSpecs.Node 0 }} 

**Os**: {{ $node.Status.NodeInfo.OSImage }} - **KernelVersion**: {{ $node.Status.NodeInfo.KernelVersion }} - **Kubelet version**: {{ $node.Status.NodeInfo.KubeletVersion }}  
{{ safe "<!-- .element: class=\"title-report\" -->" }}

**Nodes**: {{ range $nodeKey, $nodeSpecs := $reportSpecs.Node -}} {{ $nodeSpecs.Name }} {{ end }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}

{{- end -}} 
{{ safe "</div>" -}}
{{ range $nodeKey, $nodeSpecs := .KubeCIS.MasterReport }}


{{ $node := index $nodeSpecs.Node 0 -}} 
### Masters - **Os**: {{ $node.Status.NodeInfo.OSImage }} - **KernelVersion**: {{ $node.Status.NodeInfo.KernelVersion }} - **Kubelet version**: {{ $node.Status.NodeInfo.KubeletVersion }}  
{{ safe "<!-- .element: class=\"title-report\" -->" }}

##### All included:
{{ range $outputKey, $output := $nodeSpecs.Output -}}

{{ $output.TotalPass }} checks PASS

{{ $output.TotalFail }} checks FAIL

{{ $output.TotalWarn }} checks WARN

{{ $output.TotalInfo }} checks INFO

#### Scored only:

{{ $output.TotalPassScored }} checks PASS

{{ $output.TotalFailScored }} checks FAIL

{{ $output.TotalWarnScored }} checks WARN

{{ $output.TotalInfoScored }} checks INFO

{{- end -}} 
{{- end -}} 
{{ range $nodeKey, $nodeSpecs := .KubeCIS.NodeReport }}


{{ $node := index $nodeSpecs.Node 0 -}} 
### Nodes - **Os**: {{ $node.Status.NodeInfo.OSImage }} - **KernelVersion**: {{ $node.Status.NodeInfo.KernelVersion }} - **Kubelet version**: {{ $node.Status.NodeInfo.KubeletVersion }}  
{{ safe "<!-- .element: class=\"title-report\" -->" }}

##### All included:
{{ range $outputKey, $output := $nodeSpecs.Output -}}

{{ $output.TotalPass }} checks PASS

{{ $output.TotalFail }} checks FAIL

{{ $output.TotalWarn }} checks WARN

{{ $output.TotalInfo }} checks INFO

#### Scored only:

{{ $output.TotalPass }} checks PASS

{{ $output.TotalFail }} checks FAIL

{{ $output.TotalWarn }} checks WARN

{{ $output.TotalInfo }} checks INFO

{{- end -}} 
{{- end }} 
{{ range $nodeKey, $nodeSpecs := .KubeCIS.MasterReport -}}
{{- $index := 0 -}} 
{{- range $outputKey, $output := $nodeSpecs.Output -}}
{{- range $testKey, $test := $output.Tests -}}
{{- $length := len $test.Results -}} 
{{- range $resultKey, $result := $test.Results -}}
{{- if modsub $resultKey $length 0 4 }}
{{- $index = inc $index }} 


### CIS Kubernetes Result - Masters - part {{ $index }} 
{{ safe "<!-- .element: class=\"title-detailed-page\" -->" }}

{{ safe "<div style=\"display: block; text-align: left;\">" }}

{{ $node := index $nodeSpecs.Node 0 -}} 
### Masters - **Os**: {{ $node.Status.NodeInfo.OSImage }} - **KernelVersion**: {{ $node.Status.NodeInfo.KernelVersion }} - **Kubelet version**: {{ $node.Status.NodeInfo.KubeletVersion }} - {{ $output.Text }} - {{ $output.Version }}
{{ safe "<!-- .element: class=\"title-report\" -->" }}

### {{ $test.Section }} {{ $test.Desc }}: pass {{ $test.Pass }}, fail {{ $test.Fail }}, warn {{ $test.Warn }}, info {{ $test.Info }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}

{{ end -}}

**TestNumber {{ $result.TestNumber }} - Status {{ $result.Status }} - Scored {{ $result.Scored }}**
{{ safe "<!-- .element: class=\"title-report\" -->" }}
**Description:** {{ truncate $result.TestDesc 400 }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}
**Remediation:** {{ truncate $result.Remediation 400 }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}

{{ if modsub $resultKey $length 1 4 -}}
{{ safe "</div>" -}}
{{- end -}}
{{ end -}} 
{{ end -}} 
{{ end -}} 
{{ end -}}
{{ range $nodeKey, $nodeSpecs := .KubeCIS.NodeReport -}}
{{- $index := 0 -}} 
{{- range $outputKey, $output := $nodeSpecs.Output -}}
{{- range $testKey, $test := $output.Tests -}}
{{- $length := len $test.Results -}} 
{{- range $resultKey, $result := $test.Results -}}
{{- if modsub $resultKey $length 0 4 }}
{{- $index = inc $index }} 


### CIS Kubernetes Result - Nodes - part {{ $index }} 
{{ safe "<!-- .element: class=\"title-detailed-page\" -->" }}

{{ safe "<div style=\"display: block; text-align: left;\">" }}

{{ $node := index $nodeSpecs.Node 0 -}} 
#### Nodes - **Os**: {{ $node.Status.NodeInfo.OSImage }} - **KernelVersion**: {{ $node.Status.NodeInfo.KernelVersion }} - **Kubelet version**: {{ $node.Status.NodeInfo.KubeletVersion }}   - {{ $output.Text }} - {{ $output.Version }}
{{ safe "<!-- .element: class=\"title-report\" -->" }}

#### {{ $test.Section }} {{ $test.Desc }}: pass {{ $test.Pass }}, fail {{ $test.Fail }}, warn {{ $test.Warn }}, info {{ $test.Info }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}

{{ end -}}

**TestNumber {{ $result.TestNumber }} - Status {{ $result.Status }} - Scored {{ $result.Scored }}**
{{ safe "<!-- .element: class=\"title-report\" -->" }}
**Description:** {{ truncate $result.TestDesc 400 }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}
**Remediation:** {{ truncate $result.Remediation 400 }} 
{{ safe "<!-- .element: class=\"title-report\" -->" }}

{{ if modsub $resultKey $length 1 4 -}}
{{ safe "</div>" -}}
{{- end -}}
{{ end -}} 
{{ end -}} 
{{ end -}} 
{{ end }} 
